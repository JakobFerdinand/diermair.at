---
import Hero from './Hero.astro';
import Gallery from './Gallery.astro';
import Leistungen from './Leistungen.astro';
import Contact from './Contact.astro';
---
<div id="container">
    <main>
        <Hero />
        <Gallery />
        <Leistungen />
        <Contact />
    </main>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const navbar = document.querySelector('.navbar');
    const navLogoLink = document.querySelector('.nav-logo-link');
    const heroLogo = document.querySelector('#hero .hero-logo');
    if (!navbar || !heroLogo || !navLogoLink) return;

    let heroRect = heroLogo.getBoundingClientRect();
    let navRect = navLogoLink.getBoundingClientRect();

    function computeRects() {
      heroRect = heroLogo.getBoundingClientRect();
      navRect = navLogoLink.getBoundingClientRect();
    }

    function update() {
      const deltaX = navRect.left - heroRect.left;
      const deltaY = navRect.top - heroRect.top;
      const endScale = navRect.width / heroRect.width;
      const progress = Math.min(window.scrollY / heroRect.height, 1);
      heroLogo.style.setProperty('--logo-x', `${deltaX * progress}px`);
      heroLogo.style.setProperty('--logo-y', `${deltaY * progress}px`);
      heroLogo.style.setProperty('--logo-scale', 1 - progress * (1 - endScale));
      heroLogo.style.setProperty('--hero-logo-opacity', 1 - progress);
      navLogoLink.style.setProperty('--nav-logo-opacity', progress);
      navbar.classList.toggle('scrolled', progress >= 1);
    }

    update();
    window.addEventListener('scroll', update);
    window.addEventListener('resize', () => {
      computeRects();
      update();
    });
  });
</script>
